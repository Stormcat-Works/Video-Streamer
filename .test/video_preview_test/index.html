<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Video Preview Test</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    video { max-width: 100%; border: 1px solid #ccc; }
    .controls { margin-top: 10px; }
    button { margin-right: 5px; }
    input[type="range"] { width: 300px; }
  </style>
</head>
<body>
  <h1>Video Preview PoC</h1>
  <video id="videoPlayer" controls></video>
  <div class="controls">
    <button id="playBtn">Play</button>
    <button id="pauseBtn">Pause</button>
    <input type="range" id="seekBar" value="0">
    <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
  </div>

  <script>
    const video = document.getElementById('videoPlayer');
    const playBtn = document.getElementById('playBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const seekBar = document.getElementById('seekBar');
    const currentTimeEl = document.getElementById('currentTime');
    const durationEl = document.getElementById('duration');

    // preload.jsからビデオパスを取得し、<video>のsrcに設定
    window.electronAPI.getVideoPath().then(videoPath => {
      console.log('[Renderer] Received video path:', videoPath);
      video.src = videoPath;
    });

    // --- イベントリスナー ---
    playBtn.addEventListener('click', () => video.play());
    pauseBtn.addEventListener('click', () => video.pause());

    // シークバーが操作されたらビデオの再生位置を更新
    seekBar.addEventListener('input', () => {
      video.currentTime = seekBar.value;
    });

    // ビデオの再生位置が変わったらシークバーと時間表示を更新
    video.addEventListener('timeupdate', () => {
      seekBar.value = video.currentTime;
      currentTimeEl.textContent = formatTime(video.currentTime);
    });

    // ビデオのメタデータが読み込まれたら、デュレーションとシークバーの最大値を設定
    video.addEventListener('loadedmetadata', () => {
      seekBar.max = video.duration;
      durationEl.textContent = formatTime(video.duration);
    });

    // --- ヘルパー関数 ---
    function formatTime(seconds) {
      const minutes = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${minutes}:${secs.toString().padStart(2, '0')}`;
    }
  </script>
</body>
</html>
